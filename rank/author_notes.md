# 作者碎碎念

这个rank是之前做排行榜功能的时候抽象出来的一个排行榜结构。底层用的skiplist结构，例子代码已经写到skiplist仓库，参考import那个链接。

抽象出这个东西的原因是当时项目里并不止一个排行榜功能，而且那些看着像排行榜的不同的功能要展示的东西也不一样，除了唯一id和上榜数值，上榜时间是共有特征（同分的先到的排前面等等，而且把time写到这里的原因是skiplist不支持相同数值的节点，用毫秒级时间戳基本上能保证所有节点的值都是不同的），其他跟分数一起展示的东西那叫一个五花八门，然后一个排行榜功能copy一份基础代码就很臃肿，甚至如果原始排行榜发现了个bug，那抄过来的全都有这个bug，那真是令人头大的存在。

这个排行榜的上榜元素结构体内定义了一个指向拥有此元素的排行榜的指针rankPtr。这个东西是为了在排行榜（或者别的什么功能如邮件）内展示自身排名用的，因为数据节点本身不存储排名数据，正常流程下算排名的话在业务层得先找这个排行榜实例，还可能找错，找到错的榜单那排名值就是错的

不过总的来说这玩意除了update操作之外其他的直接调底层就行了，还蛮省事的（所以当时是写了那么多一堆的是啥代码……）